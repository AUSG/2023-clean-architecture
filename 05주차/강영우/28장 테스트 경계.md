# 28장 테스트 경계

- 테스트는 시스템의 일부이며, 아키텍처에도 관여한다.

# 시스템 컴포넌트인 테스트

---

- 아키텍처 시점에서는 다양한 테스트는 모두 동일하다.
- 테스트는 태생적으로 의존성 규칙을 따른다. 항상 테스트 대상이 되는 코드를 향하기 때문.
- 테스트는 독립적으로 배포 가능하다.
- 아키텍처에서 가장 바깥쪽에 위치하며, 시스템 컴포넌트 중에서도 가장 고립되어있다. 운영 상 무조건 필요하지는 않기 때문.

# 테스트를 고려한 설계

---

- 깨지기 쉬운 테스트 문제
    - 테스트가 고립되어있더라도 시스템의 설계와 잘 통합되지 않으면 테스트는 깨지기 쉬워진다.
    - 시스템에 강하게 결합되어있다면 시스템이 변경될 때 테스트도 변경되어야해서 나중에 깨지기 쉽다.
    - 깨지기 쉬운 테스트는 시스템을 뻣뻣하게 만든다는 부작용을 낳을 때가 많다.
- 테스트를 고려한 설계를 하자
    - 변동성이 있는 것에 의존하지 말라
        - ex) GUI

# 테스트 API

---

- 테스트가 모든 업무 규칙을 검증하는 데 사용할 수 있도록 특화된 API를 만들자. 이 API는
    - 보안 제약사항을 무시할 수 있고,
    - 데이터베이스같은 값비싼 자원은 건너뛰고
    - 시스템을 테스트 가능한 특정 형태로 강제
    - 사용자 인터페이스가 사용하는 인터랙터와 인터페이스 어댑터들의 상위 집합이 될 것
- 테스트 구조를 애플리케이션 구조로부터 결합을 분리하는 것이 테스트 API의 목적

## 구조적 결합

- 모든 상용 클래스/메서드에 각각 테스트 클래스/메서드가 존재하는 테스트 스위트는 애플리케이션 구조에 강하게 결합되어있다.
- 테스트 API는 애플리케이션의 구조를 테스트로부터 숨기는 데에 있다.
    - 상용 코드 또는 테스트코드를 리팩터링하거나 진화시키더라도 서로 영향을 전혀 주지 않는다.

## 보안

- 운영시스템에 테스트 API를 배포하면 위험하기 때문에, 구현부는 독립적으로 배포할 수 있는 컴포넌트로 분리해야한다.

# 결론

---

테스트는 시스템 일부이며 잘 설계되어야 한다.